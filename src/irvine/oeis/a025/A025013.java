package irvine.oeis.a025;

import irvine.math.z.Z;
import irvine.oeis.Sequence;

/**
 * A025013.
 * @author Sean A. Irvine
 */
public class A025013 implements Sequence {

  // After Vaclav Kotesovec

  private final Z[] mA = {Z.ONE, Z.ONE, Z.EIGHT, Z.valueOf(48), Z.valueOf(344), Z.valueOf(2460), Z.valueOf(18152), Z.valueOf(134512)};
  private long mN = -1;

  @Override
  public Z next() {
    if (++mN < mA.length) {
      return mA[(int) mN];
    }
    final Z[] pn = new Z[28];
    pn[0] = Z.ONE;
    for (int k = 1; k < pn.length; ++k) {
      pn[k] = pn[k - 1].multiply(mN);
    }

    final Z a0 = new Z("268435456").multiply(mN - 7).multiply(mN - 6).multiply(mN - 5).multiply(mN - 4).multiply(mN - 3).multiply(mN - 2).multiply(mN - 1).multiply(new Z("1266338946705159663").multiply(pn[21]).subtract(new Z("56342032819278770403").multiply(pn[20])).add(new Z("1164038924241070785936").multiply(pn[19])).subtract(new Z("14838528280168808822376").multiply(pn[18])).add(new Z("130797252982349066199870").multiply(pn[17])).subtract(new Z("846815533155053748593118").multiply(pn[16])).add(new Z("4175041670891005131007560").multiply(pn[15])).subtract(new Z("16039599283870935985066176").multiply(pn[14])).add(new Z("48733599982645804273452027").multiply(pn[13])).subtract(new Z("118194746249836417587316695").multiply(pn[12])).add(new Z("230014348703868094280239752").multiply(pn[11])).subtract(new Z("359860835218894942864691256").multiply(pn[10])).add(new Z("452230117658454514098832896").multiply(pn[9])).subtract(new Z("454906893490437359350785104").multiply(pn[8])).add(new Z("364037144197779530547114808").multiply(pn[7])).subtract(new Z("229587890139496090437490808").multiply(pn[6])).add(new Z("112531901379151110196686784").multiply(pn[5])).subtract(new Z("41963909286094970942790080").multiply(pn[4])).add(new Z("11504781414362537255273344").multiply(pn[3])).subtract(new Z("2186631367503284632205184").multiply(pn[2])).add(new Z("257535445713940963676160").multiply(pn[1])).subtract(new Z("14229592743808316160000"))).multiply(mA[0]);

    final Z a1 = new Z("100663296").multiply(mN - 6).multiply(mN - 5).multiply(mN - 4).multiply(mN - 3).multiply(mN - 2).multiply(mN - 1).multiply(new Z("422112982235053221").multiply(pn[21]).subtract(new Z("21413858590844922132").multiply(pn[20])).add(new Z("503879319210080320416").multiply(pn[19])).subtract(new Z("7323908758819236668952").multiply(pn[18])).add(new Z("73750569218494102663344").multiply(pn[17])).subtract(new Z("546343747339170127665276").multiply(pn[16])).add(new Z("3084148269661055739241176").multiply(pn[15])).subtract(new Z("13557808706968821918352527").multiply(pn[14])).add(new Z("47037337034990225519742741").multiply(pn[13])).subtract(new Z("129802960236829266248652252").multiply(pn[12])).add(new Z("285973763884605122470612944").multiply(pn[11])).subtract(new Z("503215399397186712581157862").multiply(pn[10])).add(new Z("705511600819484018440568422").multiply(pn[9])).subtract(new Z("783985409054581613195181972").multiply(pn[8])).add(new Z("684876040881579509487656240").multiply(pn[7])).subtract(new Z("464870694191869569604027819").multiply(pn[6])).add(new Z("241167958134959649344332952").multiply(pn[5])).subtract(new Z("93383540770860375130323288").multiply(pn[4])).add(new Z("26031964823096845742607904").multiply(pn[3])).subtract(new Z("4922580379620478142389360").multiply(pn[2])).add(new Z("564788430841552586592000").multiply(pn[1])).subtract(new Z("29833464896328693600000"))).multiply(mA[1]);

    final Z a2 = new Z("2097152").multiply(mN - 5).multiply(mN - 4).multiply(mN - 3).multiply(mN - 2).multiply(mN - 1).multiply(new Z("317851075622995075413").multiply(pn[23]).subtract(new Z("17953530467221501956783").multiply(pn[22])).add(new Z("473180259003522157328157").multiply(pn[21])).subtract(new Z("7736210308134014508064935").multiply(pn[20])).add(new Z("87989435382718987703355798").multiply(pn[19])).subtract(new Z("740042625052863903615203142").multiply(pn[18])).add(new Z("4776204371038388389130298318").multiply(pn[17])).subtract(new Z("24228233905178971744320626550").multiply(pn[16])).add(new Z("98155022461093134172249642539").multiply(pn[15])).subtract(new Z("320964121326050546166525361617").multiply(pn[14])).add(new Z("852815405372923702791231219153").multiply(pn[13])).subtract(new Z("1847930711626127914853725261947").multiply(pn[12])).add(new Z("3269088480499451236501526599080").multiply(pn[11])).subtract(new Z("4716123110288108486830341488332").multiply(pn[10])).add(new Z("5530362816686040365844418646484").multiply(pn[9])).subtract(new Z("5243211667377238232808604371240").multiply(pn[8])).add(new Z("3987921882477466926016430836434").multiply(pn[7])).subtract(new Z("2407255958173995608693810335518").multiply(pn[6])).add(new Z("1135905547351218127626169974528").multiply(pn[5])).subtract(new Z("409744820608927484444142732848").multiply(pn[4])).add(new Z("109101616694919734129812913376").multiply(pn[3])).subtract(new Z("20210477111690478340119739488").multiply(pn[2])).add(new Z("2327448062996723780066488320").multiply(pn[1])).subtract(new Z("126062510189274744845760000"))).multiply(mA[2]);

    final Z a3 = new Z("786432").multiply(mN - 4).multiply(mN - 3).multiply(mN - 2).multiply(mN - 1).multiply(new Z("105106132576528252029").multiply(pn[23]).subtract(new Z("6379313098045552652169").multiply(pn[22])).add(new Z("181260288358035755020803").multiply(pn[21])).subtract(new Z("3207568150962753735719898").multiply(pn[20])).add(new Z("39652351056230929775829000").multiply(pn[19])).subtract(new Z("363955426061382094819081356").multiply(pn[18])).add(new Z("2572806203662317804983157300").multiply(pn[17])).subtract(new Z("14337716259297515267261490867").multiply(pn[16])).add(new Z("63952729014454099129432239453").multiply(pn[15])).subtract(new Z("230542754793347241335209686777").multiply(pn[14])).add(new Z("675509647147681482147692580795").multiply(pn[13])).subtract(new Z("1612955330113572666762485462952").multiply(pn[12])).add(new Z("3138451459851041367335265948894").multiply(pn[11])).subtract(new Z("4964590406829062557651530022194").multiply(pn[10])).add(new Z("6354916535566975688850932250790").multiply(pn[9])).subtract(new Z("6536423040109155194262472892075").multiply(pn[8])).add(new Z("5349776068000324513250063364880").multiply(pn[7])).subtract(new Z("3438552026645490506650112410544").multiply(pn[6])).add(new Z("1704855026645879016340831566712").multiply(pn[5])).subtract(new Z("635841758795751297698000442608").multiply(pn[4])).add(new Z("171832919526161102062605978144").multiply(pn[3])).subtract(new Z("31670514458054923435581303360").multiply(pn[2])).add(new Z("3558231241158026507269248000").multiply(pn[1])).subtract(new Z("184738351793698105603200000"))).multiply(mA[3]);

    final Z a4 = new Z("24576").multiply(mN - 3).multiply(mN - 2).multiply(mN - 1).multiply(new Z("16329440717763033854385").multiply(pn[25]).subtract(new Z("1052698903029554308426269").multiply(pn[24])).add(new Z("31931368463129395251795930").multiply(pn[23])).subtract(new Z("606148442106548418944224722").multiply(pn[22])).add(new Z("8079352108692185358528685299").multiply(pn[21])).subtract(new Z("80420994901633571842174895727").multiply(pn[20])).add(new Z("620724413056059521069441756364").multiply(pn[19])).subtract(new Z("3807832489866530690702190104268").multiply(pn[18])).add(new Z("18879408259194791517460365471147").multiply(pn[17])).subtract(new Z("76528713710313617288499891501399").multiply(pn[16])).add(new Z("255586893828686519069103588443394").multiply(pn[15])).subtract(new Z("706688211162980277000507057756954").multiply(pn[14])).add(new Z("1621696639688457102088843743657789").multiply(pn[13])).subtract(new Z("3090047868201504491905878617837921").multiply(pn[12])).add(new Z("4882260712648524331907202744016656").multiply(pn[11])).subtract(new Z("6376498162656424732626613920275008").multiply(pn[10])).add(new Z("6850529520829454721003859429146036").multiply(pn[9])).subtract(new Z("6012985997776016441605983580837980").multiply(pn[8])).add(new Z("4273152264821346935579559000078504").multiply(pn[7])).subtract(new Z("2429372551868016576555092874174568").multiply(pn[6])).add(new Z("1087062169506532030277682655965024").multiply(pn[5])).subtract(new Z("374028939352732138729298461249664").multiply(pn[4])).add(new Z("95481122916638446292588319708672").multiply(pn[3])).subtract(new Z("17036520208658132554093410318720").multiply(pn[2])).add(new Z("1898039912768906246469652377600").multiply(pn[1])).subtract(new Z("99814822674448881352953600000"))).multiply(mA[4]);

    final Z a5 = new Z("3072").multiply(mN - 2).multiply(mN - 1).multiply(new Z("15909016187456920846269").multiply(pn[25]).subtract(new Z("1059734461110647957152686").multiply(pn[24])).add(new Z("33291681642655066697786118").multiply(pn[23])).subtract(new Z("656218867461341285887408791").multiply(pn[22])).add(new Z("9107287729170186744780910479").multiply(pn[21])).subtract(new Z("94652971587900117650444840388").multiply(pn[20])).add(new Z("764901780106472710761174207876").multiply(pn[19])).subtract(new Z("4925685275014890366789664855797").multiply(pn[18])).add(new Z("25699567185344123586902031115527").multiply(pn[17])).subtract(new Z("109871495603133527496826504477062").multiply(pn[16])).add(new Z("387783022556280798943094653089966").multiply(pn[15])).subtract(new Z("1135035677887466769983399559131697").multiply(pn[14])).add(new Z("2761086091592879191166020041276321").multiply(pn[13])).subtract(new Z("5582492537649811685393488844413728").multiply(pn[12])).add(new Z("9363621417029737180452691338823568").multiply(pn[11])).subtract(new Z("12980438388526027090436156534744531").multiply(pn[10])).add(new Z("14786218354103043922855233570176076").multiply(pn[9])).subtract(new Z("13729797435986906126160414768822696").multiply(pn[8])).add(new Z("10281518357706993081878633130131832").multiply(pn[7])).subtract(new Z("6121717909791260688679405393700784").multiply(pn[6])).add(new Z("2843415333859704035545328011548928").multiply(pn[5])).subtract(new Z("1003417730177049755755745124432640").multiply(pn[4])).add(new Z("258810756867902654472739999655040").multiply(pn[3])).subtract(new Z("45871958536907435284592333491200").multiply(pn[2])).add(new Z("4989221642714200530349325184000").multiply(pn[1])).subtract(new Z("252121973196819163723084800000"))).multiply(mA[5]);

    final Z a6 = Z.valueOf(64).multiply(mN - 1).multiply(new Z("1138338672311148829423623").multiply(pn[27]).subtract(new Z("77871710522281721950524501").multiply(pn[26])).add(new Z("2519632035678001013571282453").multiply(pn[25])).subtract(new Z("51313246078979367261231706575").multiply(pn[24])).add(new Z("738392449881574020538119871197").multiply(pn[23])).subtract(new Z("7989865214360534955190660889655").multiply(pn[22])).add(new Z("67550386191221775046309586601777").multiply(pn[21])).subtract(new Z("457721236528792058478309999306003").multiply(pn[20])).add(new Z("2529974600726350355473765383032967").multiply(pn[19])).subtract(new Z("11550139071477984913374390899475549").multiply(pn[18])).add(new Z("43937788999211932857040209989859687").multiply(pn[17])).subtract(new Z("140118599810684319720298732519065645").multiply(pn[16])).add(new Z("376039687702084909560605730908413695").multiply(pn[15])).subtract(new Z("850992575081005484615448339521733869").multiply(pn[14])).add(new Z("1624572871087001442147889429413785467").multiply(pn[13])).subtract(new Z("2613271964100926757718809640535756449").multiply(pn[12])).add(new Z("3532910697353721066997471013406739910").multiply(pn[11])).subtract(new Z("3997604354718766572108290849816817210").multiply(pn[10])).add(new Z("3764438157287793945030876662178455832").multiply(pn[9])).subtract(new Z("2927860985833373961391386772432842640").multiply(pn[8])).add(new Z("1862504895629020302840375401868456464").multiply(pn[7])).subtract(new Z("956758317460754452949306439415267376").multiply(pn[6])).add(new Z("390164289517062058774288776394201984").multiply(pn[5])).subtract(new Z("123308582220699327060021706113660288").multiply(pn[4])).add(new Z("29126835516781148111737138434380544").multiply(pn[3])).subtract(new Z("4843597033584473327790605082973440").multiply(pn[2])).add(new Z("506549709350270920277849096755200").multiply(pn[1])).subtract(new Z("25163028859216815408556915200000"))).multiply(mA[6]);

    final Z a7 = Z.valueOf(168).multiply(new Z("49661170246971776397429").multiply(pn[27]).subtract(new Z("3393301868507080762722063").multiply(pn[26])).add(new Z("109624825562462043663810897").multiply(pn[25])).subtract(new Z("2228181180181784359717737195").multiply(pn[24])).add(new Z("31986266013700034054436025209").multiply(pn[23])).subtract(new Z("345114064154421202413542989779").multiply(pn[22])).add(new Z("2907885582813737854322581960485").multiply(pn[21])).subtract(new Z("19626764406601840846468504766127").multiply(pn[20])).add(new Z("108002515062457032953975929741383").multiply(pn[19])).subtract(new Z("490633266287546484757390128753045").multiply(pn[18])).add(new Z("1856370910452887958975519888468723").multiply(pn[17])).subtract(new Z("5886011225983192426909028804947441").multiply(pn[16])).add(new Z("15701911067912355601444196215255219").multiply(pn[15])).subtract(new Z("35318367756790105666661043073055953").multiply(pn[14])).add(new Z("67021107437820486149100138670377623").multiply(pn[13])).subtract(new Z("107195964135505689905221601156288277").multiply(pn[12])).add(new Z("144159301253578280689511071240261032").multiply(pn[11])).subtract(new Z("162351320592590238089540187335086488").multiply(pn[10])).add(new Z("152227902756352866622291876800177920").multiply(pn[9])).subtract(new Z("117899679410618644160927600081496800").multiply(pn[8])).add(new Z("74628956490676236753723128383407088").multiply(pn[7])).subtract(new Z("38065941767161972982190486318816672").multiply(pn[6])).add(new Z("15349350534612565547748665637332352").multiply(pn[5])).subtract(new Z("4764135030094389933151250890588160").multiply(pn[4])).add(new Z("1094576600902744027137176756432640").multiply(pn[3])).subtract(new Z("174942082669665072769425688896000").multiply(pn[2])).add(new Z("17357601150605032634155792896000").multiply(pn[1])).subtract(new Z("807775713218810162957644800000"))).multiply(mA[7]);

    final Z v = Z.SEVEN.multiply(mN).multiply(7 * mN - 5).multiply(7 * mN - 4).multiply(7 * mN - 3).multiply(7 * mN - 2).multiply(7 * mN - 1).multiply(7 * mN + 1).multiply(new Z("1266338946705159663").multiply(pn[21]).subtract(new Z("82935150700087123326").multiply(pn[20])).add(new Z("2556810759434729723226").multiply(pn[19])).subtract(new Z("49344484875529982483520").multiply(pn[18])).add(new Z("668750374080618908240169").multiply(pn[17])).subtract(new Z("6767363258546322151971342").multiply(pn[16])).add(new Z("53074814047381583317307664").multiply(pn[15])).subtract(new Z("330497628587029674999033624").multiply(pn[14])).add(new Z("1660526062158625933363606521").multiply(pn[13])).subtract(new Z("6803142366097430662503667914").multiply(pn[12])).add(new Z("22874666753974680261669527370").multiply(pn[11])).subtract(new Z("63314706399684891049686211872").multiply(pn[10])).add(new Z("144262424315094006490769986191").multiply(pn[9])).subtract(new Z("269753772381735824030184746570").multiply(pn[8])).add(new Z("411289710797762982486665347052").multiply(pn[7])).subtract(new Z("505951121884373791252708695656").multiply(pn[6])).add(new Z("494171324719478407855325510336").multiply(pn[5])).subtract(new Z("374097923797954143160207422848").multiply(pn[4])).add(new Z("211490693770365146738909355008").multiply(pn[3])).subtract(new Z("83986549410560027958005123328").multiply(pn[2])).add(new Z("20888656766790014107377676800").multiply(pn[1])).subtract(new Z("2447232878043457925541120000")));

    final Z u = a7.add(a6).subtract(a5).subtract(a4).add(a3).add(a2).subtract(a1).subtract(a0);
    final Z t = u.divide(v);

    System.arraycopy(mA, 1, mA, 0, mA.length - 1);
    mA[mA.length - 1] = t;
    return t;
  }
}
